<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Landing Page Builder</title>
 <!--
    This page implements a simple landing page builder without any
    external dependencies.  The original builder relied on GrapesJS
    loaded via remote CDNs, which often fail in restricted
    environments (e.g. Cloudflare Workers) and result in a blank page.
    Instead, this builder provides a set of predesigned sections
    (hero, features, pricing, call to action and footer) that users
    can add, edit directly in place, reorder or remove.  Saving,
    loading and previewing pages still use the existing API endpoints.
  -->
 <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    :root {
      --page-builder-top-bar-height: 60px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f9fafb;
    }
    /* Top navigation bar */
    .top-bar {
      background: #1f2937;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
    }
    .top-bar-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .back-btn {
      background: #374151;
      color: white;
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.2s;
      font-size: 0.9rem;
    }
    .back-btn:hover {
      background: #4b5563;
      color: white;
      transform: translateY(-1px);
    }
    .top-bar h1 {
      font-size: 1.5rem;
      font-weight: 600;
    }
    .top-bar-actions {
      display: flex;
      gap: 10px;
    }
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-primary {
      background: #3b82f6;
      color: white;
    }
    .btn-primary:hover {
      background: #2563eb;
    }
    .btn-success {
      background: #10b981;
      color: white;
    }
    .btn-success:hover {
      background: #059669;
    }
    .btn-secondary {
      background: #6b7280;
      color: white;
    }
    .btn-secondary:hover {
      background: #4b5563;
    }
    /* Layout container */
    .builder-wrapper {
      display: flex;
      height: calc(100vh - var(--page-builder-top-bar-height));
      margin-top: var(--page-builder-top-bar-height);
    }
    /* Sidebar for section blocks */
    .sidebar {
      width: 260px;
      background: #ffffff;
      border-right: 1px solid #e5e7eb;
      overflow-y: auto;
      padding: 20px;
    }
    .sidebar h2 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 10px;
      color: #1f2937;
    }
    .sidebar button {
      display: block;
      width: 100%;
      margin-bottom: 10px;
      padding: 8px 12px;
      border-radius: 6px;
      background: #f3f4f6;
      color: #374151;
      border: 1px solid transparent;
      text-align: left;
      font-size: 0.9rem;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s;
    }
    .sidebar button:hover {
      background: #e5e7eb;
      border-color: #d1d5db;
    }
    /* Canvas for the assembled page */
    #builder-canvas {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: #f9fafb;
    }
    /* Style each section wrapper */
    .section-wrapper {
      position: relative;
      border: 1px dashed #d1d5db;
      margin-bottom: 20px;
      padding: 20px;
      background: white;
      border-radius: 8px;
    }
    /* Controls overlay on each section */
    .section-controls {
      position: absolute;
      top: 6px;
      right: 6px;
      display: flex;
      gap: 4px;
    }
    .section-controls button {
      background: #e5e7eb;
      border: none;
      padding: 2px 6px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
    }
    .section-controls button:hover {
      background: #d1d5db;
    }

    /* Simple overlay for editing raw HTML/CSS.  Instead of using a browser
       prompt, clicking the code (</>) button will show this overlay
       centered on the page.  It contains a textarea prepopulated with
       the current section markup and Save/Cancel buttons. */
    .code-editor-overlay {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #ffffff;
      border: 1px solid #e5e7eb;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      padding: 20px;
      z-index: 20000;
      max-width: 600px;
      width: 80%;
      max-height: 80vh;
      overflow: auto;
      border-radius: 8px;
    }
    .code-editor-overlay textarea {
      width: 100%;
      height: 300px;
      font-family: monospace;
      font-size: 0.85rem;
      padding: 10px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      resize: vertical;
    }
    .code-editor-overlay .actions {
      margin-top: 10px;
      text-align: right;
    }
    .code-editor-overlay button {
      padding: 6px 12px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      margin-left: 8px;
    }
    .code-editor-overlay .save-btn {
      background: #3b82f6;
      color: #fff;
    }
    .code-editor-overlay .cancel-btn {
      background: #6b7280;
      color: #fff;
    }
    /* Hidden error message reserved for future use */
    #builder-error {
      display: none;
      padding: 20px;
      color: #ef4444;
      text-align: center;
    }
 </style>

 <!-- Load reusable widgets for products and reviews.  These scripts
       expose global objects (ProductCards, ReviewsWidget) that can be
       used to render dynamic lists within the builder.  Placing
       these imports in the head ensures they are available before
       the builder logic executes. -->
 <!-- Schema now injected server-side - removed collection-schema.js -->
 <script type="module" src="js/product-cards.js?v=1766444251"></script>
 <script src="js/reviews-widget.js?v=1766444251"></script>
</head>
<body>
 <div class="top-bar">
 <div class="top-bar-left">
 <a href="/admin/dashboard.html" class="back-btn"> Back to Admin</a>
 <h1> Landing Page Builder</h1>
 </div>
 <div class="top-bar-actions">
 <button class="btn btn-secondary" id="load-btn"> Load</button>
 <button class="btn btn-primary" id="preview-btn"> Preview</button>
 <button class="btn btn-success" id="save-btn"> Save to R2</button>
 <button class="btn btn-secondary" id="seo-toggle-btn"> SEO</button>
 </div>
 </div>
 <!-- Main builder layout -->
 <div class="builder-wrapper">
 <aside class="sidebar">
 <h2>Sections</h2>
 <!-- Standard landing page building blocks -->
 <button type="button" data-section="hero"> Hero Section</button>
 <!-- Header and Footer are now managed via the Components admin and are automatically applied. -->
 <button type="button" data-section="features"> Features (3 Columns)</button>
 <button type="button" data-section="pricing"> Pricing Cards</button>
 <button type="button" data-section="cta"> Call to Action</button>
      
 <hr style="margin: 20px 0; border-color: #e5e7eb;">
 <!-- Dynamic data driven blocks -->
 <!-- Dynamic product and review lists are now created in the Components admin.  -->
 <button type="button" data-section="custom-html"> Custom HTML</button>
 <button type="button" data-section="page-list"> Pages List</button>
 <button type="button" data-section="image">- Image</button>
 </aside>
 <main id="builder-canvas"></main>
 </div>
 <!-- SEO settings panel (hidden by default) -->
 <div id="seo-panel" style="display:none; position:fixed; top:var(--page-builder-top-bar-height); right:0; width:300px; height:calc(100% - var(--page-builder-top-bar-height)); background:#ffffff; border-left:1px solid #e5e7eb; padding:20px; overflow-y:auto; box-shadow:-2px 0 8px rgba(0,0,0,0.05); z-index:1010;">
 <h2 style="margin-top:0; font-size:1.3rem; color:#1f2937;">SEO Settings</h2>
 <div style="margin-bottom:15px;">
 <label for="seo-title" style="display:block;font-size:0.85rem;color:#374151;margin-bottom:4px;">Page Title</label>
 <input type="text" id="seo-title" placeholder="Enter SEO title" style="width:100%; padding:8px; border:1px solid #d1d5db; border-radius:4px;" />
 </div>
 <div style="margin-bottom:15px;">
 <label for="seo-slug" style="display:block;font-size:0.85rem;color:#374151;margin-bottom:4px;">Permalink (slug)</label>
 <input type="text" id="seo-slug" placeholder="e.g., my-landing-page" style="width:100%; padding:8px; border:1px solid #d1d5db; border-radius:4px;" />
 <small style="color:#6b7280; font-size:0.75rem;">Slug will form the URL (letters, numbers and hyphens only).</small>
 </div>
 <div style="margin-bottom:15px;">
 <label for="seo-desc" style="display:block;font-size:0.85rem;color:#374151;margin-bottom:4px;">Meta Description</label>
 <textarea id="seo-desc" rows="4" placeholder="Enter SEO description" style="width:100%; padding:8px; border:1px solid #d1d5db; border-radius:4px; resize:vertical;"></textarea>
 </div>
 <p style="font-size:0.75rem; color:#6b7280;">These details appear in search results. Fill them in before saving your page.</p>
 </div>
 <!-- Hidden error element for future error messages -->
 <div id="builder-error"> Failed to initialise the builder.</div>
 <script type="module" src="js/page-builder/main.js?v=1766444251"></script>
 <!-- Load page list widget so it is available when building pages -->
 <script src="js/page-list-widget.js?v=1766444251"></script>
</body>
</html>



